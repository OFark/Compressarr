@inherits LayoutComponentBase
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization

<div class="topbar">
    <NavMenu />
</div>

<div class="main">
    <div id="content" @ref="divContent">
        <div class="@(blurred ? "blurred" : "")">
            <CascadingValue Value=ToggleBlurred>
                <CascadingValue Value=divContent>
                    @Body
                </CascadingValue>
            </CascadingValue>
        </div>
        @if (blurred)
        {
            <div class="loadingBlur">
                <div class="notice">
                    <ul class="active">
                        <li></li>
                        <li></li>
                        <li></li>
                        <li></li>
                        loading
                    </ul>
                </div>
            </div>
        }
    </div>
</div>

@code {
    public EventCallback<bool?> ToggleBlurred => EventCallback.Factory.Create<bool?>(this, toggleBlurred);

    private bool blurred { get; set; }

    private ElementReference divContent;

    public void toggleBlurred(bool? force)
    {
        if (force.HasValue)
        {
            blurred = force.Value;
        }
        else
        {
            blurred = !blurred;
        }
    }
}