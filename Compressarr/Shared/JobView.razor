<MudExpansionPanel Class="job" DisableGutters="true">
    <TitleContent>
        <MudText>
            @if (NewJob)
            {
                <MudAvatar Color="Color.Dark" Class="mr-3" Style="vertical-align: middle;">
                    <MudIcon Icon="@Icons.Outlined.PlaylistAdd" />
                </MudAvatar>
                @:New Job
            }
            else
            {
                @if (string.IsNullOrWhiteSpace(FilterType))
                {
                    <MudFab Size="Size.Small" Class="mr-3" Icon="@Icons.Outlined.Sync" Color="Color.Tertiary" />
                }
                else
                {
                    //<MudAvatar Color="Color.Transparent" Rounded="true" Image="@FilterImageSrc" Style="vertical-align: middle;" Class="mr-3" />
                    <img src="@FilterImageSrc" style="width: 40px; height: auto; vertical-align: middle; margin-right: 12px;" />
                }
                @:@Job.Filter?.Name | @Job.Preset => @Job.DestinationFolder
                <MudChip Color="@ButtonColour">@ButtonText</MudChip>
            }
        </MudText>
    </TitleContent>
    <ChildContent>
        <MudCard Elevation="0">
            @if (!Editing)
            {
                <MudCardHeader>
                    <CardHeaderContent>
                        <MudText Typo="@Typo.h6">Workload</MudText>
                    </CardHeaderContent>
                    <CardHeaderActions>
                        @if (!NewJob)
                        {
                            <MudIconButton Color="Color.Warning" Icon="@Icons.Material.Outlined.Sync" Disabled="@(!Job.Condition.SafeToInitialise)" @onclick="ReInitialise" title="Re-Initialise" />
                            <MudIconButton Color="Color.Primary" Icon="@Icons.Material.Outlined.Edit" Disabled="@(!Job.Condition.SafeToInitialise)" @onclick="() => { editJob = !editJob; }" />
                        }
                    </CardHeaderActions>
                </MudCardHeader>
            }
            <MudCardContent>
                <MudGrid>
                    <MudItem xs="12">
                        @if (Editing)
                        {
                            <MudCard Class="mb-3">
                                <MudCardHeader><CardHeaderContent><MudText Typo="Typo.h5">Workload</MudText></CardHeaderContent></MudCardHeader>
                                <MudCardContent>
                                    <MudForm>
                                        <MudList Dense="true">
                                            <MudListItem>
                                                <MudSelect Strict="true" Required="true" Label="Filter" @bind-Value="Job.FilterID" OffsetY="true">
                                                    @foreach (var c in FilterManager.Filters)
                                                        {
                                                        <MudSelectItem Value="@c.ID">@c.Name - @c.MediaSource</MudSelectItem>
                                                        }
                                                </MudSelect>
                                            </MudListItem>
                                            <MudListItem>
                                                <MudSelect Required="true" Label="Preset" @bind-Value="Job.Preset" OffsetY="true">
                                                    @foreach (var c in PresetManager.Presets)
                                                    {
                                                        <MudSelectItem Value="c" />
                                                    }
                                                </MudSelect>
                                            </MudListItem>
                                            <MudListItem>
                                                <DirectoryLookup @bind-Folder="@Job.DestinationFolder" Label="Destination Folder" Required="true" />
                                            </MudListItem>
                                        </MudList>
                                    </MudForm>
                                </MudCardContent>
                            </MudCard>
                            <MudCard Class="mb-3">
                                <MudCardHeader>
                                    <CardHeaderContent><MudText Typo="Typo.h5">FFmpeg Options</MudText></CardHeaderContent>
                                </MudCardHeader>
                                <MudCardContent>
                                    <MudForm>
                                        <MudList Dense="true">
                                            @if (Job.Preset?.VideoBitRateAutoCalc ?? false)
                                            {
                                                <MudListItem>
                                                    <MudSelect Dense="true" @bind-Value="@Job.ArgumentCalculationSettings.VideoBitRateTargetSSIM" Label="Bit Rate Target" OffsetY="true">
                                                        <MudSelectItem Value="false">Target Compression</MudSelectItem>
                                                        <MudSelectItem Value="true">Target SSIM</MudSelectItem>
                                                    </MudSelect>
                                                </MudListItem>
                                                <MudListItem>
                                                    <MudNumericField @bind-Value="@VideoBitRateTarget" Min="1" Max="100" Label="Target Percentage" Adornment="Adornment.End" AdornmentText="%" />
                                                </MudListItem>
                                            }
                                            <MudListItem>
                                                <MudSelect Dense="true" @bind-Value="@Job.ArgumentCalculationSettings.AutoCalculationType" Label="Auto Calculation Type" OffsetY="true">
                                                    @foreach (AutoCalcType r in Enum.GetValues(typeof(AutoCalcType)))
                                                        {
                                                        <MudSelectItem Value="r">@r.ToString().Humanize()</MudSelectItem>
                                                        }
                                                </MudSelect>
                                            </MudListItem>
                                            <MudListItem>
                                                <MudNumericField @bind-Value="@Job.ArgumentCalculationSettings.ArgCalcSampleSeconds" Min="1" Label="Sample length (Seconds)" />
                                            </MudListItem>

                                            @if (Job.ArgumentCalculationSettings.AutoCalculationType == AutoCalcType.FirstPastThePost)
                                            {
                                                <MudListItem>
                                                    <MudNumericField Style="" @bind-Value="MinSSIMPost" Label="Minimum SSIM" Min="0" Max="100" Adornment="Adornment.End" AdornmentText="%" />
                                                </MudListItem>
                                            }
                                        </MudList>
                                    </MudForm>
                                </MudCardContent>
                            </MudCard>
                            <MudCard Class="mb-3">
                                <MudCardHeader>
                                    <CardHeaderContent><MudText Typo="Typo.h5">Post-Processing</MudText></CardHeaderContent>
                                </MudCardHeader>
                                <MudCardContent>
                                    <MudForm>
                                        <MudList Dense="true">
                                            <MudListItem>
                                                <MudSwitch Color="Color.Secondary" @bind-Checked="@Job.ArgumentCalculationSettings.AlwaysCalculateSSIM" Label="Always calculate SSIM after encoding" />
                                            </MudListItem>
                                            <MudListItem>
                                                <MudSwitch Color="Color.Secondary" @bind-Checked="Job.AutoImport" Label="Auto Import" Disabled="@(FilterManager.GetFilter(Job.FilterID)?.MediaSource == MediaSource.Sonarr)"></MudSwitch>
                                            </MudListItem>
                                            <MudListItem>
                                                <MudNumericField Style="" @bind-Value="MinSSIM" Label="Minimum SSIM" Min="0" Max="100" Adornment="Adornment.End" AdornmentText="%" Disabled="!Job.AutoImport" />
                                            </MudListItem>
                                            <MudListItem>
                                                <MudNumericField @bind-Value="MaxComp" Label="Maximum Compression" Min="0" Max="100" Adornment="Adornment.End" AdornmentText="%" Disabled="!Job.AutoImport" />
                                            </MudListItem>
                                        </MudList>

                                    </MudForm>
                                </MudCardContent>
                            </MudCard>
                        }
                        else
                        {
                            @if (Job.WorkLoad != null)
                            {
                                <MudTable Items="Job.WorkLoad" Striped="true" Dense="true">
                                    <HeaderContent>
                                        <MudTh></MudTh>
                                        <MudTh>Name</MudTh>
                                        <MudTh>Percent</MudTh>
                                        <MudTh>ETA</MudTh>
                                        <MudTh>Frame</MudTh>
                                        <MudTh>FPS</MudTh>
                                        <MudTh>Q</MudTh>
                                        <MudTh>Size</MudTh>
                                        <MudTh>Time</MudTh>
                                        <MudTh>Length</MudTh>
                                        <MudTh>Bitrate</MudTh>
                                        <MudTh>Speed</MudTh>
                                        <MudTh>Finished</MudTh>
                                        @if (Job.AutoImport)
                                        {
                                            <MudTh>Imported</MudTh>
                                        }
                                        <MudTh>SSIM</MudTh>
                                        <MudTh>Compression</MudTh>
                                    </HeaderContent>
                                    <RowTemplate>
                                        <MudTd>
                                            <MudText>
                                                <MudIconButton Size="Size.Small" Icon="@(context.ShowDetails ? Icons.Outlined.Cancel : Icons.Outlined.Info)" OnClick="@(async () => await ToggleDetails(context))"></MudIconButton>
                                                @if (context.Condition.Processing.Processing)
                                                        {
                                                    <MudProgressCircular Class="ml-2" Style="vertical-align: middle;" Size="Size.Small" Indeterminate="true" Color="Color.Secondary" />
                                                        }
                                            </MudText>
                                        </MudTd>
                                        <MudTd DataLabel="Name">@context.SourceFileName</MudTd>
                                        <MudTd DataLabel="Percent"><MudText Align="Align.Center">@context.Percent.Adorn("%")</MudText></MudTd>
                                        <MudTd DataLabel="ETA"><MudText Align="Align.Center">@context.ETA?.Humanize(minUnit: Humanizer.Localisation.TimeUnit.Second)</MudText></MudTd>
                                        <MudTd DataLabel="Frame"><MudText Align="Align.Center">@context.Frame</MudText></MudTd>
                                        <MudTd DataLabel="FPS"><MudText Align="Align.Center">@context.FPS</MudText></MudTd>
                                        <MudTd DataLabel="Q"><MudText Align="Align.Center">@context.Q</MudText></MudTd>
                                        <MudTd DataLabel="Size"><MudText Align="Align.Center">@context.Size</MudText></MudTd>
                                        <MudTd DataLabel="Time"><MudText Align="Align.Center">@context.EncodingDuration</MudText></MudTd>
                                        <MudTd DataLabel="Length"><MudText Align="Align.Center">@context.TotalLength?.ToStringTimeSeconds()</MudText></MudTd>
                                        <MudTd DataLabel="Bitrate"><MudText Align="Align.Center">@context.Bitrate</MudText></MudTd>
                                        <MudTd DataLabel="Speed"><MudText Align="Align.Center">@context.Speed</MudText></MudTd>
                                        <MudTd DataLabel="Finished">
                                            <MudText Align="Align.Center">
                                                @if (context.Condition.HasFinished)
                                                        {
                                                            if (context.Condition.OutputCheck.Succeeded)
                                                            {
                                                        <MudIcon Color="Color.Success" Icon="@Icons.Material.Outlined.Check" />
                                                            }
                                                            else
                                                            {
                                                        <MudIcon Color="Color.Error" Icon="@Icons.Material.Outlined.Error" />
                                                            }
                                                        }
                                            </MudText>
                                        </MudTd>
                                        @if (Job.AutoImport)
                                                {
                                            <MudTd DataLabel="Imported">
                                                <MudText Align="Align.Center">
                                                    @if (context.Condition.Import.Finished)
                                                            {
                                                                if (context.Condition.Import.Succeeded)
                                                                {
                                                            <MudIcon Color="Color.Success" Icon="@Icons.Material.Outlined.Check" />
                                                                }
                                                                else
                                                                {
                                                            <MudIcon Color="Color.Error" Icon="@Icons.Material.Outlined.Error" />
                                                                }
                                                            }
                                                </MudText>
                                            </MudTd>
                                                }
                                        <MudTd DataLabel="SSIM"><MudText Align="Align.Center">@context.SSIM.ToPercent(2).Adorn("%")</MudText></MudTd>
                                        <MudTd DataLabel="Compression"><MudText Align="Align.Center">@context.Compression.ToPercent(2).Adorn("%")</MudText></MudTd>
                                    </RowTemplate>
                                    <ChildRowContent>
                                        @if (context.ShowDetails)
                                                {
                                            <MudTr>
                                                <MudTd colspan="14">
                                                    <MudTabs PanelClass="pa-4" Position="Position.Left">
                                                        <MudTabPanel Icon="@Icons.Outlined.CheckCircleOutline">
                                                            <MudCard>
                                                                <MudCardActions>
                                                                    <MudButton Disabled="context.Media.FFProbeMediaInfo != null" Variant="Variant.Outlined" Class="mr-2" Color="Color.Info" StartIcon="@Icons.Rounded.PlayArrow" OnClick="@(() => GetMediaInfo(context))">Get Media Info</MudButton>
                                                                    <MudButton Disabled="DisableCancelMediaInfoButton" Variant="Variant.Outlined" StartIcon="@Icons.Rounded.Cancel" Color="Color.Error" OnClick="@(() => CancelProcessing(context))">Cancel</MudButton>
                                                                </MudCardActions>
                                                                <MudCardContent>
                                                                    @if (context.Media.FFProbeMediaInfo != null)
                                                                            {
                                                                    <MudTreeView Dense="true" ExpandOnClick="true" Items="@context.Media.FFProbeTreeView" Context="mediaInfo">
                                                                        <ItemTemplate>
                                                                            <MudTreeViewItem @bind-Expanded="@mediaInfo.IsExpanded" Items="@mediaInfo.TreeItems" Text="@($"{mediaInfo.Title.Humanize(LetterCasing.Title)}{mediaInfo.Value.Wrap(": {0}")}")" />
                                                                        </ItemTemplate>
                                                                    </MudTreeView>
                                                                            }
                                                                </MudCardContent>
                                                            </MudCard>
                                                        </MudTabPanel>
                                                        <MudTabPanel Icon="@Icons.Outlined.PlaylistAdd">
                                                            <MudCard>
                                                                <MudCardActions>
                                                                    <MudToolBar Style="width: 100%;">
                                                                        <MudButton Disabled="context.Condition.Prepare.Processing" Variant="Variant.Outlined" Class="mr-2" StartIcon="@Icons.Rounded.PlayArrow" Color="Color.Secondary" OnClick="@(() => PrepareWorkItem(context))">Get FFmpeg Arguments</MudButton>
                                                                        <MudButton Disabled="context.Condition.Prepare.Processing" Variant="Variant.Outlined" Class="mr-2" StartIcon="@Icons.Rounded.ClearAll" Color="Color.Warning" OnClick="@(() => ClearAutoCalcHistory(context))">Clear History</MudButton>
                                                                        <MudToolBarSpacer />
                                                                        <MudButton Disabled="!context.Condition.Prepare.Processing" Variant="Variant.Outlined" StartIcon="@Icons.Rounded.Cancel" Color="Color.Error" OnClick="@(() => CancelProcessing(context))">Cancel</MudButton>
                                                                    </MudToolBar>
                                                                </MudCardActions>
                                                                <MudCardContent>
                                                                    @if (context.ArgumentCalculator?.AutoCalcVideoEncoderOptions != null && ((context.ArgumentCalculator?.AutoCalcVideoEncoderOptions.Any() ?? false) || (context.ArgumentCalculator?.VideoBitRateCalculator?.SampleResults.Any() ?? false)))
                                                                            {
                                                                        <MudText>Calculating the best settings from a sample. Actual results may vary.</MudText>
                                                                        <MudSimpleTable Dense="true">
                                                                            <thead>
                                                                                @if (context.ArgumentCalculator.Preset.VideoBitRateAutoCalc)
                                                                                        {
                                                                                    <MudTd>BitRate</MudTd>
                                                                                        }
                                                                                @foreach (var arg in context.ArgumentCalculator.AutoCalcVideoEncoderOptions)
                                                                                        {
                                                                                    <MudTd>@arg.EncoderOption.Arg</MudTd>
                                                                                        }
                                                                            </thead>
                                                                            <tbody>
                                                                                <MudTr>
                                                                                    @if (context.ArgumentCalculator.Preset.VideoBitRateAutoCalc)
                                                                                            {
                                                                                        <MudTd valign="top">
                                                                                            @if (context.ArgumentCalculator?.VideoBitRateCalculator?.SampleResults.Any() ?? false)
                                                                                                    {
                                                                                                <MudTable Dense="true" Items="context.ArgumentCalculator?.VideoBitRateCalculator?.SampleResults" Style="vertical-align: auto">
                                                                                                    <HeaderContent>
                                                                                                        <MudTh>Bitrate</MudTh>
                                                                                                        <MudTh>Compression</MudTh>
                                                                                                        <MudTh>SSIM</MudTh>
                                                                                                        <MudTh>Speed</MudTh>
                                                                                                    </HeaderContent>
                                                                                                    <RowTemplate Context="TestContext">
                                                                                                        @if (TestContext != null)
                                                                                                                {
                                                                                                            <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">@(((int)TestContext.ArgumentValue).ToBitRate() ?? "Default")</MudTd>
                                                                                                            <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">
                                                                                                                @if (TestContext.Compression > 0)
                                                                                                                        {
                                                                                                                    @:@TestContext.Compression.ToPercent(2).Adorn("%")
                                                                                                                        }
                                                                                                                        else
                                                                                                                        {
                                                                                                                    <MudProgressLinear Color="Color.Dark" Value="@TestContext.EncodingProgress" />
                                                                                                                        }
                                                                                                            </MudTd>
                                                                                                            <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">
                                                                                                                @if (@TestContext.SSIM > 0)
                                                                                                                        {
                                                                                                                    @TestContext.SSIM.ToPercent(2).Adorn("%");
                                                                                                                        }
                                                                                                                        else
                                                                                                                        {
                                                                                                                    <MudProgressLinear Color="Color.Dark" Value="@TestContext.SSIMProgress" />
                                                                                                                        }
                                                                                                            </MudTd>
                                                                                                            <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">
                                                                                                                @if (@TestContext.Speed > 0)
                                                                                                                        {
                                                                                                                    @TestContext.Speed.Adorn("x");
                                                                                                                        }
                                                                                                            </MudTd>
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                            <MudTd>@TestContext.ArgumentValue</MudTd>
                                                                                                            <MudTd>&nbsp;</MudTd>
                                                                                                            <MudTd>&nbsp;</MudTd>
                                                                                                                }
                                                                                                    </RowTemplate>
                                                                                                </MudTable>
                                                                                                    }
                                                                                        </MudTd>
                                                                                            }
                                                                                    @foreach (var arg in context.ArgumentCalculator.AutoCalcVideoEncoderOptions)
                                                                                            {
                                                                                        <MudTd valign="top">
                                                                                            <MudTable Dense="true" Items="arg.AutoPresetTests" Class="@(arg.HasSettled ? "mud-alert-outlined-secondary" : "")" Style="vertical-align: auto">
                                                                                                <HeaderContent>
                                                                                                    <MudTh>val</MudTh>
                                                                                                    <MudTh>Compression</MudTh>
                                                                                                    <MudTh>SSIM</MudTh>
                                                                                                    <MudTh>Speed</MudTh>
                                                                                                </HeaderContent>
                                                                                                <RowTemplate Context="TestContext">
                                                                                                    @if (TestContext != null)
                                                                                                            {
                                                                                                        <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">@(TestContext.ArgumentValue ?? "Default")</MudTd>
                                                                                                        <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">
                                                                                                            @if (TestContext.Compression > 0)
                                                                                                                    {
                                                                                                                @:@TestContext.Compression.ToPercent(2).Adorn("%")
                                                                                                                    }
                                                                                                                    else
                                                                                                                    {
                                                                                                                <MudProgressLinear Color="Color.Dark" Value="@TestContext.EncodingProgress" />
                                                                                                                    }
                                                                                                        </MudTd>
                                                                                                        <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">
                                                                                                            @if (@TestContext.SSIM > 0)
                                                                                                                    {
                                                                                                                @TestContext.SSIM.ToPercent(2).Adorn("%");
                                                                                                                    }
                                                                                                                    else
                                                                                                                    {
                                                                                                                <MudProgressLinear Color="Color.Dark" Value="@TestContext.SSIMProgress" />
                                                                                                                    }
                                                                                                        </MudTd>
                                                                                                        <MudTd Class="@(TestContext.Best ? "mud-theme-secondary" : "")">
                                                                                                            @if (@TestContext.Speed > 0)
                                                                                                                    {
                                                                                                                @TestContext.Speed.Adorn("x");
                                                                                                                    }
                                                                                                        </MudTd>
                                                                                                            }
                                                                                                            else
                                                                                                            {
                                                                                                        <MudTd>@TestContext.ArgumentValue</MudTd>
                                                                                                        <MudTd>&nbsp;</MudTd>
                                                                                                        <MudTd>&nbsp;</MudTd>
                                                                                                            }
                                                                                                </RowTemplate>
                                                                                            </MudTable>
                                                                                        </MudTd>
                                                                                            }
                                                                                </MudTr>
                                                                            </tbody>
                                                                        </MudSimpleTable>
                                                                            }
                                                                    @if (context.Arguments != null)
                                                                            {

                                                                        <MudList Dense="true" Class="my-3">
                                                                            @foreach (var arg in context.Arguments)
                                                                                    {
                                                                                <MudListItem>@arg</MudListItem>
                                                                                    }
                                                                        </MudList>
                                                                            }
                                                                </MudCardContent>
                                                            </MudCard>
                                                        </MudTabPanel>
                                                        <MudTabPanel Icon="@Icons.Rounded.PlayCircleOutline">
                                                            <MudCard>
                                                                <MudCardActions>
                                                                    <MudButton Disabled="!context.Condition.Prepare.Succeeded" Variant="Variant.Outlined" Class="mr-2" Color="Color.Primary" StartIcon="@Icons.Rounded.PlayArrow">Encode Video</MudButton>
                                                                    <MudButton Disabled="!context.Condition.CreatingVideo" Variant="Variant.Outlined" StartIcon="@Icons.Rounded.Cancel" Color="Color.Error" OnClick="@(() => CancelProcessing(context))">Cancel</MudButton>
                                                                </MudCardActions>
                                                                <MudCardContent>
                                                                    @if (context.Media.FFProbeMediaInfo != null)
                                                                            {
                                                                        <MudTreeView Dense="true" T="string">
                                                                            <MudTreeViewItem T="string" Text="@context.Media.FFProbeMediaInfo.format.filename"></MudTreeViewItem>
                                                                        </MudTreeView>
                                                                            }
                                                                </MudCardContent>
                                                            </MudCard>
                                                        </MudTabPanel>
                                                        <MudTabPanel Icon="@Icons.Filled.FeaturedPlayList">
                                                            @if (context.Console != null)
                                                                    {
                                                                <MudPaper Outlined="false" Square="true" class="jobEventsScrollWrapper">
                                                                    <MudPaper Square="true" Class="mud-theme-dark pa-2 jobEvents">
                                                                        <pre>
                                                                        @foreach (var e in context.Console)
                                                                                {
                                                                        <MudText Class="event" Color="e.Color" Typo="Typo.body2">@e.Message</MudText>
                                                                                }
                                                                        </pre>
                                                                    </MudPaper>
                                                                </MudPaper>
                                                                    }
                                                        </MudTabPanel>

                                                    </MudTabs>
                                                </MudTd>
                                            </MudTr>
                                                }
                                    </ChildRowContent>
                                    <PagerContent>
                                        <MudTablePager PageSizeOptions="new int[]{5, 10, 50, 100}" />
                                    </PagerContent>
                                </MudTable>
                                <MudPaper Class="mt-2" Elevation="0">
                                    <MudProgressLinear Color="Color.Primary" Value="initialisationProgress" />
                                </MudPaper>
                                @if (!NewJob)
                                {
                                    <MudToolBar>
                                        <MudButton Variant="Variant.Filled" FullWidth="true" Color="@ButtonColour" @onclick="StartJob" @onmouseover="() => { mouseOnButton = true; }" @onmouseout="() => { mouseOnButton = false; }">@ButtonText</MudButton>
                                    </MudToolBar>
                                }
                            }
                            else
                            {
                                <MudSkeleton Width="100%" Height="30px" />
                                <MudSkeleton Width="20%" />
                                <MudSkeleton Width="30%" />
                                <MudSkeleton Width="18%" />
                                <MudSkeleton Width="35%" />
                            }
                        }
                    </MudItem>
                    <MudItem xs="12">
                        @if (Job.Events?.Any() ?? false)
                        {
                            <MudText Typo="Typo.h5"><MudIcon Icon="@Icons.Outlined.Article" Color="Color.Primary" /> Log</MudText>
                            <MudPaper Outlined="false" Square="true" class="jobEventsScrollWrapper">
                                <MudPaper Square="true" Class="mud-theme-dark pa-2 jobEvents">
                                    @if (Job.Events != null)
                                    {
                                        <pre>
                                @foreach (var e in Job.Events)
                                {
                                        <MudText Class="event" Color="e.Color" Typo="Typo.body2">@e.Date.ToString("HH:mm:ss") - @e.Message</MudText>
                                }
                            </pre>
                                    }
                                </MudPaper>
                            </MudPaper>
                        }
                        else if (!NewJob)
                        {
                            <MudSkeleton Width="10%" />
                            <MudSkeleton Width="100%" Height="195px" />
                        }
                    </MudItem>
                </MudGrid>
            </MudCardContent>
            <MudCardActions>
                @if (Editing)
                {
                    <MudButton @onclick="SaveJob" Variant="Variant.Filled" FullWidth="true" Size="Size.Large" Disabled="@(!SaveEnabled)" Color="Color.Primary" StartIcon="@Icons.Material.Outlined.Save">Save</MudButton>
                    @if (!NewJob)
                    {
                        <MudButton @onclick="DeleteJob" Color="Color.Error" StartIcon="@Icons.Material.Outlined.Delete">Delete</MudButton>
                        @if (canReload)
                        {
                            <MudButton StartIcon="@Icons.Material.Outlined.Refresh" Color="Color.Secondary" @onclick="ReloadJob">Reload</MudButton>
                        }
                    }
                }
            </MudCardActions>
        </MudCard>
    </ChildContent>
</MudExpansionPanel>

@code {



}
